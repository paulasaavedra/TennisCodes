password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
library(dplyr)
library(tidyr)
library(data.table)
dbm <- db[tourney_level == 'ATP']
dbm <- dbm[match_status != 'Walkover']
dbm <- dbm[!round_match %in% c('Q1', 'Q2', 'Q3')]
# Limpia match_id y separa en year + id
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)
dbm[, id := as.character(id)]
dbm[, year := as.integer(year)]
# Ganados por jugador y año
ganados <- dbm[w_nac == 'Argentina', .N, by = .(year, Jugador = w_player)]
# Perdidos por jugador y año
perdidos <- dbm[l_nac == 'Argentina', .N, by = .(year, Jugador = l_player)]
# Renombrar columnas
setnames(ganados, "N", "Ganados")
setnames(perdidos, "N", "Perdidos")
# Unir resultados por jugador y año
resultados <- merge(ganados, perdidos, by = c("year", "Jugador"), all = TRUE)
# Reemplazar NAs con 0
resultados[is.na(resultados)] <- 0
# Calcular jugados
resultados[, Jugados := Ganados + Perdidos]
# Calcular porcentajes
resultados[, `% ganados` := round(Ganados * 100 / Jugados, 1)]
resultados[, `% perdidos` := round(Perdidos * 100 / Jugados, 1)]
View(resultados)
View(resultados)
library(dplyr)
library(tidyr)
library(data.table)
dbm <- db[tourney_level == 'ATP']
dbm <- dbm[match_status != 'Walkover']
dbm <- dbm[!round_match %in% c('Q1', 'Q2', 'Q3')]
# Limpia match_id y separa en year + id
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)
dbm[, id := as.character(id)]
dbm[, year := as.integer(year)]
# Ganados por jugador y año
ganados <- dbm[w_nac == 'Argentina', .N, by = .(year, Jugador = w_player)]
# Perdidos por jugador y año
perdidos <- dbm[l_nac == 'Argentina', .N, by = .(year, Jugador = l_player)]
# Renombrar columnas
setnames(ganados, "N", "Ganados")
setnames(perdidos, "N", "Perdidos")
# Unir resultados por jugador y año
resultados <- merge(ganados, perdidos, by = c("year", "Jugador"), all = TRUE)
# Reemplazar NAs con 0
resultados[is.na(resultados)] <- 0
# Calcular jugados
resultados[, Jugados := Ganados + Perdidos]
# Calcular porcentajes
resultados[, `% ganados` := round(Ganados * 100 / Jugados, 1)]
resultados[, `% perdidos` := round(Perdidos * 100 / Jugados, 1)]
View(resultados)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Clay']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
#dbm <- dbm[grepl("RIO DE J", tourney_name, ignore.case = TRUE)]
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
dbm <- dbm [year=='2025']
#dbm <- dbm [tourney_level=='M1000']
# Filtrar por id
#dbm <- dbm[id %in% c( "0308")]
ganados <- dbm[w_nac == 'Argentina']
perdidos <- dbm[l_nac=='Argentina']
ganados <- ganados[,.N, by = w_player]
perdidos <- perdidos[,.N, by = l_player]
# Nombrar columnas con "Jugador" y "Ganados" "Perdidos"
names(ganados)[1] <- names(perdidos)[1] <- "Jugador"
names(ganados)[2] <- "Ganados"
names(perdidos)[2] <- "Perdidos"
# Unir resultados por nombre
resultados <- merge(ganados, perdidos, by = c("Jugador"), all=TRUE)
# Poner 0 a los que tienen NA
resultados[is.na(resultados)] <- 0
# sumar ganados y perdidos en una misma columna llamada "Jugados"
resultados <- resultados[, Jugados:=Ganados+Perdidos]
#resultados <- resultados[Jugados>4]
resultados <- resultados[, PorGan:= round(resultados$Ganados*100/resultados$Jugados, 1)]
resultados <- resultados[, PorPer:= round(resultados$Perdidos*100/resultados$Jugados, 1)]
names(resultados)[5] <- "% ganados"
names(resultados)[6] <- "% perdidos"
View(resultados)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Clay']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
#dbm <- dbm[grepl("RIO DE J", tourney_name, ignore.case = TRUE)]
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
#dbm <- dbm [year=='2025']
#dbm <- dbm [tourney_level=='M1000']
# Filtrar por id
#dbm <- dbm[id %in% c( "0308")]
ganados <- dbm[w_nac == 'Argentina']
perdidos <- dbm[l_nac=='Argentina']
ganados <- ganados[,.N, by = w_player]
perdidos <- perdidos[,.N, by = l_player]
# Nombrar columnas con "Jugador" y "Ganados" "Perdidos"
names(ganados)[1] <- names(perdidos)[1] <- "Jugador"
names(ganados)[2] <- "Ganados"
names(perdidos)[2] <- "Perdidos"
# Unir resultados por nombre
resultados <- merge(ganados, perdidos, by = c("Jugador"), all=TRUE)
# Poner 0 a los que tienen NA
resultados[is.na(resultados)] <- 0
# sumar ganados y perdidos en una misma columna llamada "Jugados"
resultados <- resultados[, Jugados:=Ganados+Perdidos]
#resultados <- resultados[Jugados>4]
resultados <- resultados[, PorGan:= round(resultados$Ganados*100/resultados$Jugados, 1)]
resultados <- resultados[, PorPer:= round(resultados$Perdidos*100/resultados$Jugados, 1)]
names(resultados)[5] <- "% ganados"
names(resultados)[6] <- "% perdidos"
View(resultados)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
View(db)
library(dplyr)
df <- df %>%
mutate(
w_seed = ifelse(is.na(w_seed), 0, w_seed),
l_seed = ifelse(is.na(l_seed), 0, l_seed)
)
library(dplyr)
db <- db %>%
mutate(
w_seed = ifelse(is.na(w_seed), 0, w_seed),
l_seed = ifelse(is.na(l_seed), 0, l_seed)
)
auxi <- db [l_seed>0 & l_nac=='Argentina']
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Clay']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
#dbm <- dbm[grepl("RIO DE J", tourney_name, ignore.case = TRUE)]
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
library(dplyr)
dbm <- dbm %>%
mutate(
w_seed = ifelse(is.na(w_seed), 0, w_seed),
l_seed = ifelse(is.na(l_seed), 0, l_seed)
)
auxi <- dbm [l_seed>0 & l_nac=='Argentina']
auxito <- auxi [,.N,by=c('year','id','tourney_name')]
View(auxito)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
#setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
# Primero me quedo con los argentinos y que fueron top 100
auxi <- rank
rank <- rank [country == 'ARG' &  rank_position<101]
library (zoo)
rank[, date_rank := as.Date(date_rank, format="%d/%m/%Y")]
# Creamos una lista de todas las fechas posibles para cada jugador
rank_expanded <- rank[, .(date_rank = seq(min(date_rank), max(date_rank), by = "day")), by = player]
# Primero me quedo con los argentinos y que fueron top 100
auxi <- rank
rank <- rank [country == 'ARG' &  rank_position<101]
library (zoo)
rank[, date_rank := as.Date(date_rank, format="%d/%m/%Y")]
# Creamos una lista de todas las fechas posibles para cada jugador
rank_expanded <- rank[, .(date_rank = seq(min(date_rank), max(date_rank), by = "day")), by = player]
# Primero me quedo con los argentinos y que fueron top 100
auxi <- rank
rank <- rank [country == 'ARG' &  rank_position<101]
library (zoo)
rank[, date_rank := as.Date(date_rank, format="%d/%m/%Y")]
# Creamos una lista de todas las fechas posibles para cada jugador
rank_expanded <- rank[, .(date_rank = seq(min(date_rank), max(date_rank), by = "day")), by = player]
# Primero me quedo con los argentinos y que fueron top 100
auxi <- rank
rank <- rank [country == 'ARG' &  rank_position<101]
library (zoo)
rank[, date_rank := as.Date(date_rank, format="%d/%m/%Y")]
# Creamos una lista de todas las fechas posibles para cada jugador
rank_expanded <- rank[, .(date_rank = seq(min(date_rank), max(date_rank), by = "day")), by = player]
View(rank)
# Primero me quedo con los argentinos y que fueron top 100
auxi <- rank
rank <- rank [country == 'ARG' &  rank_position<101]
library (zoo)
rank[, date_rank := as.Date(date_rank, format="%d/%m/%Y")]
View(rank)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
# Primero me quedo con los argentinos y que fueron top 100
auxi <- rank
rank <- rank [country == 'ARG' &  rank_position<101]
library (zoo)
rank[, date_rank := as.Date(date_rank, format="%d/%m/%Y")]
# Creamos una lista de todas las fechas posibles para cada jugador
rank_expanded <- rank[, .(date_rank = seq(min(date_rank), max(date_rank), by = "day")), by = player]
rank_expanded <- rank[, .(
date_rank = seq(as.Date(min(date_rank)), as.Date(max(date_rank)), by = "day")
), by = player]
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
# Primero me quedo con los argentinos y que fueron top 100
auxi <- rank
rank <- rank [country == 'ARG' &  rank_position<101]
library (zoo)
rank[, date_rank := as.Date(date_rank, format="%d/%m/%Y")]
# Creamos una lista de todas las fechas posibles para cada jugador
rank_expanded <- rank[, .(date_rank = seq(min(date_rank), max(date_rank), by = "day")), by = player]
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
# Primero me quedo con los argentinos y que fueron top 100
auxi <- rank
rank <- rank [country == 'ARG' &  rank_position<101]
library (zoo)
rank[, date_rank := as.Date(date_rank, format="%d/%m/%Y")]
rank <- rank[!is.na(date_rank)]
# filtrar jugadores con más de una fecha
rank <- rank[, if (.N > 1) .SD, by = player]
# Creamos una lista de todas las fechas posibles para cada jugador
rank_expanded <- rank[, .(date_rank = seq(min(date_rank), max(date_rank), by = "day")), by = player]
# Hacemos un join con el datatable original para obtener los valores de las columnas correspondientes
rank_expanded <- merge(rank_expanded, rank, by = c("player", "date_rank"), all.x = TRUE)
# Ahora rellenamos las filas faltantes con los valores de la fecha anterior
rank_expanded[, `:=`(
rank_position = zoo::na.locf(rank_position, na.rm = FALSE),
rank_change = zoo::na.locf(rank_change, na.rm = FALSE),
country = zoo::na.locf(country, na.rm = FALSE),
player_id = zoo::na.locf(player_id, na.rm = FALSE),
player = zoo::na.locf(player, na.rm = FALSE),
age = zoo::na.locf(age, na.rm = FALSE),
points = zoo::na.locf(points, na.rm = FALSE),
points_change = zoo::na.locf(points_change, na.rm = FALSE),
tourney_played = zoo::na.locf(tourney_played, na.rm = FALSE),
dropping = zoo::na.locf(dropping, na.rm = FALSE),
next_best = zoo::na.locf(next_best, na.rm = FALSE)
)]
rank_expanded <- as.data.table(rank_expanded)
dias <- rank_expanded[rank_position<101]
dias <- dias[,.N,by=player]
dias[, semanas := round(N / 7,2)]
dias[, años := N / 365]
View(dias)
dias <- rank_expanded[rank_position<35]
dias <- dias[,.N,by=player]
dias[, semanas := round(N / 7,2)]
dias[, años := N / 365]
View(dias)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
auxi <- db[round_match=='R16']
auxi <- db[round_match=='R16' & w_nac=='Argentina']
auxito <- auxi [,.N,by=c('tourney_name','date_match')]
View(auxito)
auuuuxi <- auxito[,.N,by=date_match]
View(auuuuxi)
View(auxito)
auxi <- db[round_match=='R16' & w_nac=='Argentina' & tourney_level!= 'CH']
auxito <- auxi [,.N,by=c('tourney_name','date_match')]
auuuuxi <- auxito[,.N,by=date_match]
View(auxi)
View(auxi)
View(auxi)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
#setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
#setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Clay']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
cuartos <- dbm [round_match=='R16']
cuartos <- dbm [round_match=='R16' & w_nac == 'Argentina']
auxi <- cuartos [.N,by=c('tourney_date')]
auxi <- cuartos [.N,by=c('date_match')]
auxi <- cuartos [,.N,by=c('date_match')]
View(auxi)
View(dbm)
View(cuartos)
