library(tidyr)
library(data.table)
dbm <- db[tourney_level != 'CH']
dbm <- dbm[match_status != 'Walkover']
dbm <- dbm[!round_match %in% c('Q1', 'Q2', 'Q3')]
# Limpia match_id y separa en year + id
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)
dbm[, id := as.character(id)]
dbm[, year := as.integer(year)]
dbm <- dbm [tourney_level=='GS']
# Ganados por jugador y año
ganados <- dbm[w_nac == 'Argentina', .N, by = .(year, Jugador = w_player)]
# Perdidos por jugador y año
perdidos <- dbm[l_nac == 'Argentina', .N, by = .(year, Jugador = l_player)]
# Renombrar columnas
setnames(ganados, "N", "Ganados")
setnames(perdidos, "N", "Perdidos")
# Unir resultados por jugador y año
resultados <- merge(ganados, perdidos, by = c("year", "Jugador"), all = TRUE)
# Reemplazar NAs con 0
resultados[is.na(resultados)] <- 0
# Calcular jugados
resultados[, Jugados := Ganados + Perdidos]
# Calcular porcentajes
resultados[, `% ganados` := round(Ganados * 100 / Jugados, 1)]
resultados[, `% perdidos` := round(Perdidos * 100 / Jugados, 1)]
# Para cada año, quedate con los 3 jugadores con más triunfos
top3_por_año <- resultados[
order(-Ganados),
head(.SD, 2),
by = year
]
View(top3_por_año)
library(dplyr)
library(tidyr)
library(data.table)
dbm <- db[tourney_level != 'CH']
dbm <- dbm[match_status != 'Walkover']
dbm <- dbm[!round_match %in% c('Q1', 'Q2', 'Q3')]
# Limpia match_id y separa en year + id
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)
dbm[, id := as.character(id)]
dbm[, year := as.integer(year)]
dbm <- dbm [tourney_level=='GS']
# Ganados por jugador y año
ganados <- dbm[w_nac == 'Argentina', .N, by = .(year, Jugador = w_player)]
# Perdidos por jugador y año
perdidos <- dbm[l_nac == 'Argentina', .N, by = .(year, Jugador = l_player)]
# Renombrar columnas
setnames(ganados, "N", "Ganados")
setnames(perdidos, "N", "Perdidos")
# Unir resultados por jugador y año
resultados <- merge(ganados, perdidos, by = c("year", "Jugador"), all = TRUE)
# Reemplazar NAs con 0
resultados[is.na(resultados)] <- 0
# Calcular jugados
resultados[, Jugados := Ganados + Perdidos]
# Calcular porcentajes
resultados[, `% ganados` := round(Ganados * 100 / Jugados, 1)]
resultados[, `% perdidos` := round(Perdidos * 100 / Jugados, 1)]
# Para cada año, quedate con los 3 jugadores con más triunfos
top3_por_año <- resultados[
order(-Ganados),
head(.SD, 3),
by = year
]
View(top3_por_año)
View(dbm)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Clay']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
dbm <- dbm [tourney_level=='GS']
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
dbm <- dbm [year=='2025']
#dbm <- dbm [tourney_level=='M1000']
# Filtrar por id
#dbm <- dbm[id %in% c( "0308")]
ganados <- dbm[w_nac == 'Argentina']
perdidos <- dbm[l_nac=='Argentina']
ganados <- ganados[,.N, by = w_player]
perdidos <- perdidos[,.N, by = l_player]
# Nombrar columnas con "Jugador" y "Ganados" "Perdidos"
names(ganados)[1] <- names(perdidos)[1] <- "Jugador"
names(ganados)[2] <- "Ganados"
names(perdidos)[2] <- "Perdidos"
# Unir resultados por nombre
resultados <- merge(ganados, perdidos, by = c("Jugador"), all=TRUE)
# Poner 0 a los que tienen NA
resultados[is.na(resultados)] <- 0
# sumar ganados y perdidos en una misma columna llamada "Jugados"
resultados <- resultados[, Jugados:=Ganados+Perdidos]
#resultados <- resultados[Jugados>4]
resultados <- resultados[, PorGan:= round(resultados$Ganados*100/resultados$Jugados, 1)]
resultados <- resultados[, PorPer:= round(resultados$Perdidos*100/resultados$Jugados, 1)]
names(resultados)[5] <- "% ganados"
names(resultados)[6] <- "% perdidos"
View(resultados)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Clay']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
dbm <- dbm [tourney_level=='GS']
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
#dbm <- dbm [year=='2025']
#dbm <- dbm [tourney_level=='M1000']
# Filtrar por id
#dbm <- dbm[id %in% c( "0308")]
ganados <- dbm[w_nac == 'Argentina']
perdidos <- dbm[l_nac=='Argentina']
ganados <- ganados[,.N, by = w_player]
perdidos <- perdidos[,.N, by = l_player]
# Nombrar columnas con "Jugador" y "Ganados" "Perdidos"
names(ganados)[1] <- names(perdidos)[1] <- "Jugador"
names(ganados)[2] <- "Ganados"
names(perdidos)[2] <- "Perdidos"
# Unir resultados por nombre
resultados <- merge(ganados, perdidos, by = c("Jugador"), all=TRUE)
# Poner 0 a los que tienen NA
resultados[is.na(resultados)] <- 0
# sumar ganados y perdidos en una misma columna llamada "Jugados"
resultados <- resultados[, Jugados:=Ganados+Perdidos]
#resultados <- resultados[Jugados>4]
resultados <- resultados[, PorGan:= round(resultados$Ganados*100/resultados$Jugados, 1)]
resultados <- resultados[, PorPer:= round(resultados$Perdidos*100/resultados$Jugados, 1)]
names(resultados)[5] <- "% ganados"
names(resultados)[6] <- "% perdidos"
View(resultados)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
dbm <- dbm [surface =='Hard']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
#dbm <- dbm [year=='2025']
#dbm <- dbm [tourney_level=='M1000']
# Filtrar por id
#dbm <- dbm[id %in% c( "0308")]
ganados <- dbm[w_nac == 'Argentina']
perdidos <- dbm[l_nac=='Argentina']
ganados <- ganados[,.N, by = w_player]
perdidos <- perdidos[,.N, by = l_player]
# Nombrar columnas con "Jugador" y "Ganados" "Perdidos"
names(ganados)[1] <- names(perdidos)[1] <- "Jugador"
names(ganados)[2] <- "Ganados"
names(perdidos)[2] <- "Perdidos"
# Unir resultados por nombre
resultados <- merge(ganados, perdidos, by = c("Jugador"), all=TRUE)
# Poner 0 a los que tienen NA
resultados[is.na(resultados)] <- 0
# sumar ganados y perdidos en una misma columna llamada "Jugados"
resultados <- resultados[, Jugados:=Ganados+Perdidos]
#resultados <- resultados[Jugados>4]
resultados <- resultados[, PorGan:= round(resultados$Ganados*100/resultados$Jugados, 1)]
resultados <- resultados[, PorPer:= round(resultados$Perdidos*100/resultados$Jugados, 1)]
names(resultados)[5] <- "% ganados"
names(resultados)[6] <- "% perdidos"
View(resultados)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Hard']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
#dbm <- dbm [year=='2025']
dbm <- dbm [tourney_level=='GS']
# Filtrar por id
#dbm <- dbm[id %in% c( "0308")]
ganados <- dbm[w_nac == 'Argentina']
perdidos <- dbm[l_nac=='Argentina']
ganados <- ganados[,.N, by = w_player]
perdidos <- perdidos[,.N, by = l_player]
# Nombrar columnas con "Jugador" y "Ganados" "Perdidos"
names(ganados)[1] <- names(perdidos)[1] <- "Jugador"
names(ganados)[2] <- "Ganados"
names(perdidos)[2] <- "Perdidos"
# Unir resultados por nombre
resultados <- merge(ganados, perdidos, by = c("Jugador"), all=TRUE)
# Poner 0 a los que tienen NA
resultados[is.na(resultados)] <- 0
# sumar ganados y perdidos en una misma columna llamada "Jugados"
resultados <- resultados[, Jugados:=Ganados+Perdidos]
#resultados <- resultados[Jugados>4]
resultados <- resultados[, PorGan:= round(resultados$Ganados*100/resultados$Jugados, 1)]
resultados <- resultados[, PorPer:= round(resultados$Perdidos*100/resultados$Jugados, 1)]
names(resultados)[5] <- "% ganados"
names(resultados)[6] <- "% perdidos"
View(resultados)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Hard']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
#dbm <- dbm [year=='2025']
#dbm <- dbm [tourney_level=='GS']
# Filtrar por id
#dbm <- dbm[id %in% c( "0308")]
ganados <- dbm[w_nac == 'Argentina']
perdidos <- dbm[l_nac=='Argentina']
ganados <- ganados[,.N, by = w_player]
perdidos <- perdidos[,.N, by = l_player]
# Nombrar columnas con "Jugador" y "Ganados" "Perdidos"
names(ganados)[1] <- names(perdidos)[1] <- "Jugador"
names(ganados)[2] <- "Ganados"
names(perdidos)[2] <- "Perdidos"
# Unir resultados por nombre
resultados <- merge(ganados, perdidos, by = c("Jugador"), all=TRUE)
# Poner 0 a los que tienen NA
resultados[is.na(resultados)] <- 0
# sumar ganados y perdidos en una misma columna llamada "Jugados"
resultados <- resultados[, Jugados:=Ganados+Perdidos]
#resultados <- resultados[Jugados>4]
resultados <- resultados[, PorGan:= round(resultados$Ganados*100/resultados$Jugados, 1)]
resultados <- resultados[, PorPer:= round(resultados$Perdidos*100/resultados$Jugados, 1)]
names(resultados)[5] <- "% ganados"
names(resultados)[6] <- "% perdidos"
View(resultados)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Clay']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
dbm <- dbm [year=='2025']
jugadores_que_mas_derrotaron_argentinos <- dbm [l_nac == 'Argentina',.N,by=c('w_player')]
View(jugadores_que_mas_derrotaron_argentinos)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
# setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
# setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
View(db)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
# setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
# setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
View(db)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
# setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
# setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
# setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
# setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
# Cargar librerías
library(DBI)
library(RMariaDB)
library(data.table)
# Establecer la conexión
con <- dbConnect(
MariaDB(),
dbname = "tennis_db",
host = "localhost",
user = "root",
password = "tennis46"
)
# Listar tablas disponibles
dbListTables(con)
# Leo atp_simple
setnames(db <- setDT(dbReadTable(con, "atp_simple")), tolower(names(db)))
# setnames(pbyp <- setDT(dbReadTable(con, "atp_pbyp")), tolower(names(pbyp)))
# setnames(rank <- setDT(dbReadTable(con, "atp_rankings")), tolower(names(rank)))
# setnames(db_stats_w_t <- setDT(dbReadTable(con, "atp_stats_w_t")), tolower(names(db_stats_w_t)))
# setnames(db_stats_l_t <- setDT(dbReadTable(con, "atp_stats_l_t")), tolower(names(db_stats_l_t)))
# Cerrar la conexión
dbDisconnect(con)
library(dplyr)
library(tidyr)
library(kableExtra)
dbm <- db [tourney_level != 'CH']
dbm <- dbm [match_status != 'Walkover']
#dbm <- dbm [surface =='Clay']
dbm <- dbm [round_match != 'Q1' & round_match != 'Q2' & round_match != 'Q3']
#Filtra una fecha
#dbm <- dbm [as.Date(date_match, format = "%Y-%m-%d") > as.Date("2024-12-20")]
# Filtra enero o febrero
#dbm <- dbm[month(as.Date(date_match, format = "%Y-%m-%d")) %in% c(1, 2, 3)]
#dbm <- dbm[grepl("RIO DE J", tourney_name, ignore.case = TRUE)]
dbm[, match_id := sub("_\\d+$", "", match_id)]
dbm <- dbm %>%
separate(match_id, into = c("year", "id"), sep = "_")
setDT(dbm)  # Convierte dbm en data.table si dejó de serlo
dbm[, id := as.character(id)]
colnames(dbm)
# Cargar librerías
library(dplyr)
library(ggplot2)
# Definir jugadores
players <- c("Jannik Sinner", "Carlos Alcaraz")
# Filtrar solo los partidos entre ellos en GS
dbm_filtered <- dbm %>%
filter(
tourney_level == "GS",
w_player %in% players,
l_player %in% players
)
# Ver resumen del head-to-head
head_to_head <- dbm_filtered %>%
count(winner, name = "victorias")
print(head_to_head)
# ==============================
# 1. Gráfico de victorias por jugador
# ==============================
ggplot(dbm_filtered, aes(x = winner, fill = winner)) +
geom_bar() +
labs(title = "Head-to-Head en Grand Slams: Sinner vs Alcaraz",
x = "Ganador", y = "Número de victorias") +
theme_minimal()
# ==============================
# 2. Gráfico de duración de partidos (en minutos)
# ==============================
ggplot(dbm_filtered, aes(x = year, y = time_total, color = winner)) +
geom_point(size = 3) +
geom_line(aes(group = 1), linetype = "dashed") +
labs(title = "Duración de los partidos entre Sinner y Alcaraz en GS",
x = "Año", y = "Duración total (min)") +
theme_minimal()
# Cargar librerías
library(dplyr)
library(ggplot2)
# Definir jugadores
players <- c("Jannik Sinner", "Carlos Alcaraz")
# Filtrar solo los partidos entre ellos en GS
dbm_filtered <- dbm %>%
filter(
tourney_level == "GS",
w_player %in% players,
l_player %in% players
)
# Ver resumen del head-to-head
head_to_head <- dbm_filtered %>%
count(winner, name = "victorias")
print(head_to_head)
# ==============================
# 1. Gráfico de victorias por jugador
# ==============================
ggplot(dbm_filtered, aes(x = winner, fill = winner)) +
geom_bar() +
labs(title = "Head-to-Head en Grand Slams: Sinner vs Alcaraz",
x = "Ganador", y = "Número de victorias") +
theme_minimal()
# ==============================
# 2. Gráfico de duración de partidos (en minutos)
# ==============================
ggplot(dbm_filtered, aes(x = year, y = time_total, color = winner)) +
geom_point(size = 3) +
geom_line(aes(x = year, y = time_total), inherit.aes = FALSE, linetype = "dashed") +
labs(title = "Duración de los partidos entre Sinner y Alcaraz en GS",
x = "Año", y = "Duración total (min)") +
theme_minimal()
# ==============================
# 3. Gráfico de rondas de enfrentamientos
# ==============================
ggplot(dbm_filtered, aes(x = round_match, fill = winner)) +
geom_bar(position = "dodge") +
labs(title = "Rondas de enfrentamientos en GS (Sinner vs Alcaraz)",
x = "Ronda", y = "Número de partidos") +
theme_minimal()
# ==============================
ggplot(dbm_filtered, aes(x = winner, fill = winner)) +
geom_bar() +
labs(title = "Head-to-Head en Grand Slams: Sinner vs Alcaraz",
x = "Ganador", y = "Número de victorias") +
theme_minimal()
ggplot(dbm_filtered, aes(x = year, y = time_total, color = winner)) +
geom_point(size = 3) +
geom_line(aes(x = year, y = time_total), inherit.aes = FALSE, linetype = "dashed") +
labs(title = "Duración de los partidos entre Sinner y Alcaraz en GS",
x = "Año", y = "Duración total (min)") +
theme_minimal()
ggplot(dbm_filtered, aes(x = round_match, fill = winner)) +
geom_bar(position = "dodge") +
labs(title = "Rondas de enfrentamientos en GS (Sinner vs Alcaraz)",
x = "Ronda", y = "Número de partidos") +
theme_minimal()
